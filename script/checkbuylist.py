# -*- coding: UTF-8 -*-
import pymysql

null = None
buy_list = [{"cart_id":25119915,"quantity":1,"card_id":3756,"card_name_cn":"\u81ea\u7136\u6728\u9cde\u9f99","card_version_id":33400,"card_version_number":"TRC1-JP032","card_version_rarity":"SR","card_version_image":"http:\/\/kanabell.jihuanshe.com\/100020811.jpg?imageslim","cart_price":"3.00","cart_status":1,"product_id":3417396,"product_price":"3.00","product_quantity":1,"product_condition":1,"product_remark":"\u65e5","product_publish_location":null,"game_key":"ygo","game_sub_key":"ocg"},{"cart_id":25119908,"quantity":1,"card_id":1416,"card_name_cn":"\u65e0\u6548","card_version_id":11911,"card_version_number":"SOD-JP057","card_version_rarity":"SR","card_version_image":"http:\/\/custom.jihuanshe.com\/11911.jpg?imageslim","cart_price":"3.00","cart_status":1,"product_id":8195997,"product_price":"3.00","product_quantity":1,"product_condition":1,"product_remark":"\u65e5","product_publish_location":null,"game_key":"ygo","game_sub_key":"ocg"},{"cart_id":25119891,"quantity":1,"card_id":4325,"card_name_cn":"\u7a76\u6781\u5ff5\u52a8\u529b\u4f53","card_version_id":25023,"card_version_number":"DREV-JP039","card_version_rarity":"SR","card_version_image":"http:\/\/kanabell.jihuanshe.com\/73709126.jpg?imageslim","cart_price":"3.00","cart_status":1,"product_id":7326561,"product_price":"3.00","product_quantity":1,"product_condition":1,"product_remark":"\u65e5","product_publish_location":null,"game_key":"ygo","game_sub_key":"ocg"},{"cart_id":25119871,"quantity":1,"card_id":7457,"card_name_cn":"\u8d85\u91cd\u9b54\u517d \u4e5d\u5c3e-B","card_version_id":33672,"card_version_number":"BOSH-JP048","card_version_rarity":"SR","card_version_image":"http:\/\/kanabell.jihuanshe.com\/100028605.jpg?imageslim","cart_price":"3.50","cart_status":1,"product_id":3417521,"product_price":"3.50","product_quantity":1,"product_condition":1,"product_remark":"\u65e5","product_publish_location":null,"game_key":"ygo","game_sub_key":"ocg"},{"cart_id":25119867,"quantity":1,"card_id":5343,"card_name_cn":"\u5149\u5b50\u8776\u523a\u5ba2","card_version_id":28608,"card_version_number":"GAOV-JP044","card_version_rarity":"SR","card_version_image":"http:\/\/kanabell.jihuanshe.com\/100003563.jpg?imageslim","cart_price":"3.50","cart_status":1,"product_id":7048709,"product_price":"3.50","product_quantity":1,"product_condition":1,"product_remark":"\u65e5","product_publish_location":null,"game_key":"ygo","game_sub_key":"ocg"},{"cart_id":25119801,"quantity":1,"card_id":7721,"card_name_cn":"\u771f\u9f99\u7687 \u963f\u8006\u5c3c\u9a6c\u5179\u5fb7\u00b7\u6d88\u706d","card_version_id":35965,"card_version_number":"TDIL-JP025","card_version_rarity":"SR","card_version_image":"http:\/\/kanabell.jihuanshe.com\/100034979.jpg?imageslim","cart_price":"5.50","cart_status":1,"product_id":1010713,"product_price":"5.50","product_quantity":1,"product_condition":1,"product_remark":"\u65e5","product_publish_location":null,"game_key":"ygo","game_sub_key":"ocg"},{"cart_id":25119751,"quantity":1,"card_id":4179,"card_name_cn":"\u9b54\u8f70\u795e\u517d \u4ef6","card_version_id":24542,"card_version_number":"DT08-JP040","card_version_rarity":"SR","card_version_image":"http:\/\/kanabell.jihuanshe.com\/73708085.jpg?imageslim","cart_price":"10.00","cart_status":1,"product_id":3417314,"product_price":"10.00","product_quantity":1,"product_condition":1,"product_remark":"\u65e5","product_publish_location":null,"game_key":"ygo","game_sub_key":"ocg"},{"cart_id":25119656,"quantity":1,"card_id":3314,"card_name_cn":"\u9b54\u8f70\u795e \u96f7\u6587","card_version_id":21170,"card_version_number":"DS14-JPL33","card_version_rarity":"UR","card_version_image":"http:\/\/kanabell.jihuanshe.com\/100015440.jpg?imageslim","cart_price":"6.00","cart_status":1,"product_id":3709797,"product_price":"6.00","product_quantity":1,"product_condition":1,"product_remark":"\u65e5","product_publish_location":null,"game_key":"ygo","game_sub_key":"ocg"},{"cart_id":25119638,"quantity":1,"card_id":3574,"card_name_cn":"\u6697\u51a5\u7834\u574f\u795e","card_version_id":22201,"card_version_number":"GX06-JP003","card_version_rarity":"UR","card_version_image":"http:\/\/kanabell.jihuanshe.com\/100019878.jpg?imageslim","cart_price":"7.00","cart_status":1,"product_id":2808411,"product_price":"7.00","product_quantity":1,"product_condition":1,"product_remark":"","product_publish_location":null,"game_key":"ygo","game_sub_key":"ocg"},{"cart_id":25119618,"quantity":1,"card_id":2106,"card_name_cn":"\u5927\u8111\u7834\u574f\u866b","card_version_id":16449,"card_version_number":"GX03-JP001","card_version_rarity":"UR","card_version_image":"http:\/\/kanabell.jihuanshe.com\/100019890.jpg?imageslim","cart_price":"8.00","cart_status":1,"product_id":5923423,"product_price":"8.00","product_quantity":1,"product_condition":1,"product_remark":"\u65e5","product_publish_location":null,"game_key":"ygo","game_sub_key":"ocg"},{"cart_id":25119453,"quantity":1,"card_id":6093,"card_name_cn":"\u767d\u591c\u4e4b\u9a91\u58eb \u76d6\u4e9a","card_version_id":30728,"card_version_number":"VE09-JP003","card_version_rarity":"UR","card_version_image":"http:\/\/kanabell.jihuanshe.com\/100014482.jpg?imageslim","cart_price":"6.00","cart_status":1,"product_id":3537913,"product_price":"6.00","product_quantity":1,"product_condition":1,"product_remark":"\u65e5","product_publish_location":null,"game_key":"ygo","game_sub_key":"ocg"},{"cart_id":25119449,"quantity":1,"card_id":9650,"card_name_cn":"\u9632\u706b\u8d85\u8d8a\u9f99","card_version_id":48919,"card_version_number":"DANE-JP036","card_version_rarity":"UR","card_version_image":"http:\/\/kanabell.jihuanshe.com\/100138620.jpg?imageslim","cart_price":"6.00","cart_status":1,"product_id":7530330,"product_price":"6.00","product_quantity":2,"product_condition":1,"product_remark":"\u65e5","product_publish_location":null,"game_key":"ygo","game_sub_key":"ocg"},{"cart_id":25119427,"quantity":1,"card_id":3313,"card_name_cn":"\u6b63\u4e49\u76df\u519b \u9020\u98ce\u9e1f","card_version_id":21161,"card_version_number":"LE13-JP002","card_version_rarity":"UR","card_version_image":"http:\/\/kanabell.jihuanshe.com\/1003519.jpg?imageslim","cart_price":"4.00","cart_status":1,"product_id":2638951,"product_price":"4.00","product_quantity":1,"product_condition":1,"product_remark":"\u65e5","product_publish_location":null,"game_key":"ygo","game_sub_key":"ocg"},{"cart_id":25119424,"quantity":1,"card_id":321,"card_name_cn":"\u5047\u9762\u9b54\u517d \u9b3c\u9762\u4fee\u9053\u58eb","card_version_id":3329,"card_version_number":"DL3-049","card_version_rarity":"UR","card_version_image":"http:\/\/kanabell.jihuanshe.com\/100018921.jpg?imageslim","cart_price":"4.00","cart_status":1,"product_id":7048549,"product_price":"4.00","product_quantity":1,"product_condition":1,"product_remark":"\u65e5","product_publish_location":null,"game_key":"ygo","game_sub_key":"ocg"},{"cart_id":25119412,"quantity":1,"card_id":4240,"card_name_cn":"\u6076\u9b54\u6df7\u6c8c\u738b","card_version_id":24737,"card_version_number":"TSHD-JP041","card_version_rarity":"UR","card_version_image":"http:\/\/kanabell.jihuanshe.com\/73708338.jpg?imageslim","cart_price":"4.00","cart_status":1,"product_id":3337584,"product_price":"4.00","product_quantity":1,"product_condition":1,"product_remark":"\u65e5","product_publish_location":null,"game_key":"ygo","game_sub_key":"ocg"},{"cart_id":25119398,"quantity":1,"card_id":8213,"card_name_cn":"\u53e4\u4ee3\u7684\u673a\u68b0\u70ed\u6838\u9f99","card_version_id":36812,"card_version_number":"SR03-JP001","card_version_rarity":"UR","card_version_image":"http:\/\/kanabell.jihuanshe.com\/100040596.jpg?imageslim","cart_price":"3.00","cart_status":1,"product_id":4060651,"product_price":"3.00","product_quantity":2,"product_condition":1,"product_remark":"\u65e5 \u9876\u4e0a\u5fae\u5fae\u767d\u8fb9","product_publish_location":null,"game_key":"ygo","game_sub_key":"ocg"},{"cart_id":25119386,"quantity":1,"card_id":1313,"card_name_cn":"\u80e1\u72fc\u7075\u9a91\u58eb","card_version_id":11175,"card_version_number":"EE2-JP184","card_version_rarity":"UR","card_version_image":"http:\/\/custom.jihuanshe.com\/11175.jpg?imageslim","cart_price":"3.00","cart_status":1,"product_id":4310224,"product_price":"3.00","product_quantity":1,"product_condition":2,"product_remark":"9-93 \u65e5","product_publish_location":null,"game_key":"ygo","game_sub_key":"ocg"},{"cart_id":25119381,"quantity":1,"card_id":5429,"card_name_cn":"\u5148\u53f2\u9057\u4ea7 \u6c34\u6676\u5916\u661f\u4eba","card_version_id":28851,"card_version_number":"REDU-JP042","card_version_rarity":"UR","card_version_image":"http:\/\/kanabell.jihuanshe.com\/100003977.jpg?imageslim","cart_price":"3.00","cart_status":1,"product_id":4720747,"product_price":"3.00","product_quantity":1,"product_condition":1,"product_remark":"\u65e5","product_publish_location":null,"game_key":"ygo","game_sub_key":"ocg"},{"cart_id":25119374,"quantity":1,"card_id":3069,"card_name_cn":"\u5e1d\u5c38\u795e\u5b98","card_version_id":20001,"card_version_number":"WJMP-JP009","card_version_rarity":"UR","card_version_image":"http:\/\/kanabell.jihuanshe.com\/73709017.jpg?imageslim","cart_price":"3.00","cart_status":1,"product_id":7048498,"product_price":"3.00","product_quantity":3,"product_condition":1,"product_remark":"\u65e5","product_publish_location":null,"game_key":"ygo","game_sub_key":"ocg"},{"cart_id":25111685,"quantity":1,"card_id":5828,"card_name_cn":"\u9f7f\u8f6e\u9f7f\u8f6e\u9f7f\u8f6e","card_version_id":29996,"card_version_number":"DS14-JPM25","card_version_rarity":"UR","card_version_image":"http:\/\/kanabell.jihuanshe.com\/100015392.jpg?imageslim","cart_price":"2.00","cart_status":1,"product_id":2637450,"product_price":"2.00","product_quantity":1,"product_condition":1,"product_remark":"\u65e5","product_publish_location":null,"game_key":"ygo","game_sub_key":"ocg"},{"cart_id":25111678,"quantity":1,"card_id":5219,"card_name_cn":"\u6697\u9ed1\u8000\u661f\u9f99","card_version_id":28107,"card_version_number":"SD22-JP002","card_version_rarity":"UR","card_version_image":"http:\/\/kanabell.jihuanshe.com\/100003057.jpg?imageslim","cart_price":"1.80","cart_status":1,"product_id":7582168,"product_price":"1.80","product_quantity":3,"product_condition":1,"product_remark":"\u65e5","product_publish_location":null,"game_key":"ygo","game_sub_key":"ocg"},{"cart_id":25111493,"quantity":1,"card_id":5885,"card_name_cn":"\u7279\u83b1\u6069\u4e4b\u866b\u60d1\u9b54","card_version_id":35883,"card_version_number":"GP16-JP003","card_version_rarity":"GSER","card_version_image":"http:\/\/kanabell.jihuanshe.com\/100033635.jpg?imageslim","cart_price":"40.00","cart_status":1,"product_id":5936175,"product_price":"40.00","product_quantity":1,"product_condition":1,"product_remark":"\u65e5","product_publish_location":null,"game_key":"ygo","game_sub_key":"ocg"},{"cart_id":25107911,"quantity":1,"card_id":3409,"card_name_cn":"\u7d27\u6025\u540c\u8c03","card_version_id":21555,"card_version_number":"CSOC-JP065","card_version_rarity":"UTR","card_version_image":"http:\/\/kanabell.jihuanshe.com\/100004684.jpg?imageslim","cart_price":"15.00","cart_status":1,"product_id":7490213,"product_price":"15.00","product_quantity":1,"product_condition":1,"product_remark":"\u65e5","product_publish_location":null,"game_key":"ygo","game_sub_key":"ocg"},{"cart_id":25107619,"quantity":1,"card_id":5227,"card_name_cn":"\u739b\u7279","card_version_id":28126,"card_version_number":"PP14-JP004","card_version_rarity":"SER","card_version_image":"http:\/\/kanabell.jihuanshe.com\/100003226.jpg?imageslim","cart_price":"5.00","cart_status":1,"product_id":6446602,"product_price":"5.00","product_quantity":1,"product_condition":1,"product_remark":"\u65e5","product_publish_location":null,"game_key":"ygo","game_sub_key":"ocg"},{"cart_id":25107592,"quantity":1,"card_id":4137,"card_name_cn":"\u72ee\u5934\u77ed\u543b\u9cc4","card_version_id":24372,"card_version_number":"PP12-JP005","card_version_rarity":"SER","card_version_image":"http:\/\/kanabell.jihuanshe.com\/73707673.jpg?imageslim","cart_price":"1.50","cart_status":1,"product_id":6467735,"product_price":"1.50","product_quantity":2,"product_condition":1,"product_remark":"\u65e5","product_publish_location":null,"game_key":"ygo","game_sub_key":"ocg"},{"cart_id":25106490,"quantity":1,"card_id":1672,"card_name_cn":"\u529b\u91cf\u7ed3\u5408","card_version_id":41728,"card_version_number":"DP20-JP022","card_version_rarity":"N","card_version_image":"http:\/\/kanabell.jihuanshe.com\/100098207.jpg?imageslim","cart_price":"1.20","cart_status":1,"product_id":2684571,"product_price":"1.20","product_quantity":1,"product_condition":2,"product_remark":"\u65e5","product_publish_location":null,"game_key":"ygo","game_sub_key":"ocg"},{"cart_id":25106316,"quantity":1,"card_id":7272,"card_name_cn":"DDD \u9738\u9f99\u738b \u6f58\u5fb7\u62c9\u521a","card_version_id":33196,"card_version_number":"VS15-JPD00","card_version_rarity":"ESR","card_version_image":"http:\/\/kanabell.jihuanshe.com\/100022017.jpg?imageslim","cart_price":"14.00","cart_status":1,"product_id":7231255,"product_price":"14.00","product_quantity":1,"product_condition":1,"product_remark":"\u65e5 \u5de6\u4e0a\u89d2\u8f7b\u5fae\u649e\u89d2\u5de6\u8fb9\u8f7b\u5fae\u767d\u8fb9","product_publish_location":null,"game_key":"ygo","game_sub_key":"ocg"},{"cart_id":25106263,"quantity":1,"card_id":1489,"card_name_cn":"\u65af\u82ac\u514b\u65af\u00b7\u5b89\u5fb7\u9c81\u5409\u5c3c\u65af","card_version_id":12470,"card_version_number":"PP7-JP001","card_version_rarity":"UR","card_version_image":"http:\/\/kanabell.jihuanshe.com\/1001020.jpg?imageslim","cart_price":"3.00","cart_status":1,"product_id":8175738,"product_price":"3.00","product_quantity":1,"product_condition":2,"product_remark":"\u65e5","product_publish_location":null,"game_key":"ygo","game_sub_key":"ocg"},{"cart_id":25106197,"quantity":1,"card_id":831,"card_name_cn":"\u4e9a\u9a6c\u900a\u5f29\u5f13\u961f","card_version_id":7712,"card_version_number":"EE1-JP151","card_version_rarity":"SR","card_version_image":"http:\/\/kanabell.jihuanshe.com\/100001407.jpg?imageslim","cart_price":"6.50","cart_status":1,"product_id":8196154,"product_price":"6.50","product_quantity":1,"product_condition":1,"product_remark":"\u65e5","product_publish_location":null,"game_key":"ygo","game_sub_key":"ocg"},{"cart_id":25106193,"quantity":1,"card_id":3964,"card_name_cn":"\u7834\u90aa\u4e4b\u523b\u5370","card_version_id":23726,"card_version_number":"SOVR-JP079","card_version_rarity":"SR","card_version_image":"http:\/\/kanabell.jihuanshe.com\/100011981.jpg?imageslim","cart_price":"2.50","cart_status":1,"product_id":8196251,"product_price":"2.50","product_quantity":3,"product_condition":1,"product_remark":"\u65e5","product_publish_location":null,"game_key":"ygo","game_sub_key":"ocg"},{"cart_id":24884945,"quantity":1,"card_id":2648,"card_name_cn":"\u9b54\u6cd5\u5251\u58eb \u5c3c\u5965","card_version_id":18351,"card_version_number":"ST13-JP003","card_version_rarity":"N","card_version_image":"http:\/\/custom.jihuanshe.com\/18351.jpg?imageslim","cart_price":"0.30","cart_status":1,"product_id":7703408,"product_price":"0.30","product_quantity":1,"product_condition":1,"product_remark":"\u65e5","product_publish_location":null,"game_key":"ygo","game_sub_key":"ocg"},{"cart_id":24734698,"quantity":1,"card_id":9532,"card_name_cn":"\u6765\u81ea\u519c\u56ed\u7684\u914d\u9001","card_version_id":44666,"card_version_number":"YCPC-JP003","card_version_rarity":"N","card_version_image":"http:\/\/kanabell.jihuanshe.com\/100133259.jpg?imageslim","cart_price":"10.00","cart_status":1,"product_id":8076328,"product_price":"10.00","product_quantity":4,"product_condition":1,"product_remark":"\u65e5","product_publish_location":null,"game_key":"ygo","game_sub_key":"ocg"},{"cart_id":24709067,"quantity":1,"card_id":9531,"card_name_cn":"\u9b42\u4e4b\u5f00\u5c01","card_version_id":44664,"card_version_number":"YCPC-JP002","card_version_rarity":"N","card_version_image":"http:\/\/kanabell.jihuanshe.com\/100133250.jpg?imageslim","cart_price":"10.00","cart_status":1,"product_id":8076410,"product_price":"10.00","product_quantity":3,"product_condition":1,"product_remark":"\u65e5","product_publish_location":null,"game_key":"ygo","game_sub_key":"ocg"},{"cart_id":24709065,"quantity":1,"card_id":9530,"card_name_cn":"\u85af\u85af\u4e0e\u7247\u7247","card_version_id":44662,"card_version_number":"YCPC-JP001","card_version_rarity":"N","card_version_image":"http:\/\/kanabell.jihuanshe.com\/100133247.jpg?imageslim","cart_price":"10.00","cart_status":1,"product_id":8076340,"product_price":"10.00","product_quantity":1,"product_condition":1,"product_remark":"\u65e5","product_publish_location":null,"game_key":"ygo","game_sub_key":"ocg"},{"cart_id":24709054,"quantity":1,"card_id":1236,"card_name_cn":"\u9ed1\u9b54\u672f\u5c11\u5973","card_version_id":44670,"card_version_number":"YCPC-JP005","card_version_rarity":"N","card_version_image":"http:\/\/kanabell.jihuanshe.com\/100133271.jpg?imageslim","cart_price":"35.00","cart_status":1,"product_id":8076586,"product_price":"35.00","product_quantity":3,"product_condition":1,"product_remark":"\u65e5","product_publish_location":null,"game_key":"ygo","game_sub_key":"ocg"},{"cart_id":23608388,"quantity":3,"card_id":3126,"card_name_cn":"\u6f0f\u7535","card_version_id":20282,"card_version_number":"LODT-JP056","card_version_rarity":"R","card_version_image":"http:\/\/kanabell.jihuanshe.com\/1002359.jpg?imageslim","cart_price":"1.00","cart_status":1,"product_id":2710319,"product_price":"1.00","product_quantity":4,"product_condition":1,"product_remark":"\u65e5","product_publish_location":null,"game_key":"ygo","game_sub_key":"ocg"},{"cart_id":22040318,"quantity":1,"card_id":1672,"card_name_cn":"\u529b\u91cf\u7ed3\u5408","card_version_id":13757,"card_version_number":"SD26-JP022","card_version_rarity":"N","card_version_image":"http:\/\/kanabell.jihuanshe.com\/100015552.jpg?imageslim","cart_price":"1.00","cart_status":1,"product_id":5158737,"product_price":"1.00","product_quantity":1,"product_condition":1,"product_remark":"\u65e5","product_publish_location":null,"game_key":"ygo","game_sub_key":"ocg"},{"cart_id":22040317,"quantity":1,"card_id":1672,"card_name_cn":"\u529b\u91cf\u7ed3\u5408","card_version_id":13757,"card_version_number":"SD26-JP022","card_version_rarity":"N","card_version_image":"http:\/\/kanabell.jihuanshe.com\/100015552.jpg?imageslim","cart_price":"0.50","cart_status":1,"product_id":6215854,"product_price":"0.50","product_quantity":1,"product_condition":2,"product_remark":"\u65e5","product_publish_location":null,"game_key":"ygo","game_sub_key":"ocg"}]


# 打开数据库连接
db = pymysql.connect("localhost", "root", "123456", "card")
# 使用 cursor() 方法创建一个游标对象 cursor
cursor = db.cursor()

card_id_list = []
for buy_data in buy_list:
    if buy_data["quantity"] > 1:
        print(buy_data["card_name_cn"], "大于1")
    name = buy_data["card_name_cn"]
    card_id = buy_data["card_version_number"]
    sql = "select `card_id` from packinfo where `card_no` = '%s';"
    # 使用 execute()  方法执行 SQL 查询
    cursor.execute(sql, (card_id, ))
    # 使用 fetchone() 方法获取单条数据.
    data = cursor.fetchall()
    if not data:
        print("找不到ID %s %s" % (card_id, buy_data["card_name_cn"]))
        sql = "select `id`, `name` from texts where `name` = '%s' "
        # 使用 execute()  方法执行 SQL 查询
        cursor.execute(sql, (name,))
        # 使用 fetchone() 方法获取单条数据.
        data = cursor.fetchall()
        if not data:
            print("找不到名字 %s %s" % (card_id, buy_data["card_name_cn"]))
        else:
            for d in data:
                card_id_list.append(d[0])
    else:
        card_id_list.append(data[0][0])

sql = "select `id` from buy where `id` in %s and `isbuy`=1;"
arg = str(card_id_list).replace('[', '(').replace(']', ')')
cursor.execute(sql, (arg, ))
# 使用 fetchone() 方法获取单条数据.
data = cursor.fetchall()
if not data:
    print('全部没买过')
else:
    isbuy_list = []
    for d in data:
        isbuy_list.append(d[0])
    sql = "select `id`, `name` from texts where `id` in %s;"
    arg = str(isbuy_list).replace('[', '(').replace(']', ')')
    # 使用 execute()  方法执行 SQL 查询
    cursor.execute(sql, (arg, ))
    # 使用 fetchone() 方法获取单条数据.
    data = cursor.fetchall()
    print("已购买列表：")
    for d in data:
        print(d)